# Task ID: 4
# Title: Fix database connection and detection issues
# Status: pending
# Dependencies: 1, 3
# Priority: high
# Description: Resolve timeout issues in database detection and connection pooling
# Details:
Address database detection timeouts, connection pool configuration issues. Fix detection logic for both final and temporary databases (_tmp). Improve timeout handling from 10s to 20s for ClickHouse operations. Ensure proper connection cleanup and retry mechanisms.

# Test Strategy:
Test connection pooling under load, validate timeout improvements, verify cleanup
